

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wf_psf.metrics.metrics_interface &mdash; wf-psf 3.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9570fddd" />
      <link rel="stylesheet" type="text/css" href="../_static/twemoji.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=309026bb" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=af2ce170"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
      <script src="https://unpkg.com/twemoji@latest/dist/twemoji.min.js"></script>
      <script src="../_static/twemoji.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="wf_psf.plotting" href="wf_psf.plotting.html" />
    <link rel="prev" title="wf_psf.metrics.metrics" href="wf_psf.metrics.metrics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #ffb400" >

          
          
          <a href="../index.html" class="icon icon-home">
            wf-psf
              <img src="../_static/cosmostat_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About WaveDiff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installing WaveDiff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Running WaveDiff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basic_execution.html">Basic Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="wf_psf.data.html">wf_psf.data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="wf_psf.metrics.html">wf_psf.metrics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="wf_psf.metrics.metrics.html">wf_psf.metrics.metrics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">wf_psf.metrics.metrics_interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler"><code class="docutils literal notranslate"><span class="pre">MetricsParamsHandler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wf_psf.metrics.metrics_interface.evaluate_model"><code class="docutils literal notranslate"><span class="pre">evaluate_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.plotting.html">wf_psf.plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.psf_models.html">wf_psf.psf_models</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.run.html">wf_psf.run</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.sims.html">wf_psf.sims</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.training.html">wf_psf.training</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.utils.html">wf_psf.utils</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../z_ref.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #ffb400" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">wf-psf</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="wf_psf.metrics.html">wf_psf.metrics</a></li>
      <li class="breadcrumb-item active">wf_psf.metrics.metrics_interface</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/wf_psf.metrics.metrics_interface.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-wf_psf.metrics.metrics_interface">
<span id="wf-psf-metrics-metrics-interface"></span><h1>wf_psf.metrics.metrics_interface<a class="headerlink" href="#module-wf_psf.metrics.metrics_interface" title="Link to this heading"></a></h1>
<p>Metrics Interface.</p>
<p>A module which defines the classes and methods
to manage metrics evaluation of the trained psf model.</p>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Jennifer Pollack &lt;<a class="reference external" href="mailto:jennifer&#46;pollack&#37;&#52;&#48;cea&#46;fr">jennifer<span>&#46;</span>pollack<span>&#64;</span>cea<span>&#46;</span>fr</a>&gt;</p>
</dd>
</dl>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#wf_psf.metrics.metrics_interface.evaluate_model" title="wf_psf.metrics.metrics_interface.evaluate_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_model</span></code></a>(metrics_params, ...)</p></td>
<td><p>Evaluate the trained model on both training and test datasets by computing various metrics.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler" title="wf_psf.metrics.metrics_interface.MetricsParamsHandler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MetricsParamsHandler</span></code></a>(metrics_params, ...)</p></td>
<td><p>Metrics Parameters Handler.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="wf_psf.metrics.metrics_interface.MetricsParamsHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wf_psf.metrics.metrics_interface.</span></span><span class="sig-name descname"><span class="pre">MetricsParamsHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trained_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wf_psf/metrics/metrics_interface.html#MetricsParamsHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Metrics Parameters Handler.</p>
<p>A class to handle metrics-related parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics_params</strong> (<em>Recursive Namespace object</em>) – Recursive Namespace object containing metrics input parameters</p></li>
<li><p><strong>trained_model</strong> (<em>Recursive Namespace object</em>) – Recursive Namespace object containing trained model input parameters</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_mono_rmse" title="wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_mono_rmse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_metrics_mono_rmse</span></code></a>(psf_model, ...)</p></td>
<td><p>Evaluate RMSE metrics for Monochromatic PSF.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_opd" title="wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_opd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_metrics_opd</span></code></a>(psf_model, simPSF, ...)</p></td>
<td><p>Evaluate Optical Path Difference (OPD) metrics.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_polychromatic_lowres" title="wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_polychromatic_lowres"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_metrics_polychromatic_lowres</span></code></a>(...)</p></td>
<td><p>Evaluate RMSE metrics for low-resolution polychromatic PSF.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_shape" title="wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_metrics_shape</span></code></a>(psf_model, simPSF, ...)</p></td>
<td><p>Evaluate PSF Shape Metrics.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_mono_rmse">
<span class="sig-name descname"><span class="pre">evaluate_metrics_mono_rmse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">simPSF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/wf_psf/metrics/metrics_interface.html#MetricsParamsHandler.evaluate_metrics_mono_rmse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_mono_rmse" title="Link to this definition"></a></dt>
<dd><p>Evaluate RMSE metrics for Monochromatic PSF.</p>
<p>This method computes Root Mean Square Error (RMSE) metrics for a
monochromatic Point Spread Function (PSF) model across a range of
wavelengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psf_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – An instance of the PSF model selected for metrics evaluation.</p></li>
<li><p><strong>simPSF</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – An instance of the PSFSimulator.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – A DataConfigHandler object containing training and test datasets.</p></li>
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – <p>Dictionary containing dataset details, including:
- <code class="docutils literal notranslate"><span class="pre">positions</span></code> (Star positions)
- <code class="docutils literal notranslate"><span class="pre">C_poly</span></code>  (Tensor or None, optional)</p>
<blockquote>
<div><p>The Zernike coefficient matrix used in generating simulations of the PSF model. This
matrix defines the Zernike polynomials up to a given order used to simulate the PSF
field. It may be present in some datasets or only required for some classes.
If not present or required, the model will proceed without it.</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary containing RMSE, relative RMSE, and their corresponding
standard deviation values computed over a wavelength range.</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rmse_lda</span></code><span class="classifier">float</span></dt><dd><p>Root Mean Square Error (RMSE) over wavelengths.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rel_rmse_lda</span></code><span class="classifier">float</span></dt><dd><p>Relative RMSE over wavelengths.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">std_rmse_lda</span></code><span class="classifier">float</span></dt><dd><p>Standard deviation of RMSE over wavelengths.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">std_rel_rmse_lda</span></code><span class="classifier">float</span></dt><dd><p>Standard deviation of relative RMSE over wavelengths.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_opd">
<span class="sig-name descname"><span class="pre">evaluate_metrics_opd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">simPSF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/wf_psf/metrics/metrics_interface.html#MetricsParamsHandler.evaluate_metrics_opd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_opd" title="Link to this definition"></a></dt>
<dd><p>Evaluate Optical Path Difference (OPD) metrics.</p>
<p>This method computes Root Mean Square Error (RMSE) and relative RMSE
for Optical Path Differences (OPD), along with their standard deviations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psf_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – An instance of the PSF model selected for metrics evaluation.</p></li>
<li><p><strong>simPSF</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – An instance of the PSFSimulator.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – A DataConfigHandler object containing training and test datasets.</p></li>
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – <p>Dictionary containing dataset details, including:
- <code class="docutils literal notranslate"><span class="pre">positions</span></code> (Star positions)
- <code class="docutils literal notranslate"><span class="pre">C_poly</span></code> (Tensor or None, optional)</p>
<blockquote>
<div><p>The Zernike coefficient matrix used in generating simulations of the PSF model. This
matrix defines the Zernike polynomials up to a given order used to simulate the PSF
field. It may be present in some datasets or only required for some classes.
If not present or required, the model will proceed without it.</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary containing RMSE, relative RMSE, and their corresponding
standard deviation values for OPD metrics.</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rmse_opd</span></code><span class="classifier">float</span></dt><dd><p>Root Mean Square Error (RMSE) for OPD.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rel_rmse_opd</span></code><span class="classifier">float</span></dt><dd><p>Relative RMSE for OPD.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rmse_std_opd</span></code><span class="classifier">float</span></dt><dd><p>Standard deviation of RMSE for OPD.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rel_rmse_std_opd</span></code><span class="classifier">float</span></dt><dd><p>Standard deviation of relative RMSE for OPD.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_polychromatic_lowres">
<span class="sig-name descname"><span class="pre">evaluate_metrics_polychromatic_lowres</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">simPSF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/wf_psf/metrics/metrics_interface.html#MetricsParamsHandler.evaluate_metrics_polychromatic_lowres"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_polychromatic_lowres" title="Link to this definition"></a></dt>
<dd><p>Evaluate RMSE metrics for low-resolution polychromatic PSF.</p>
<p>This method computes Root Mean Square Error (RMSE) metrics for a
low-resolution polychromatic Point Spread Function (PSF) model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psf_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – An instance of the PSF model selected for metrics evaluation.</p></li>
<li><p><strong>simPSF</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – An instance of the PSFSimulator.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – A DataConfigHandler object containing training and test datasets.</p></li>
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – <p>Dictionary containing dataset details, including:
- <code class="docutils literal notranslate"><span class="pre">SEDs</span></code> (Spectral Energy Distributions)
- <code class="docutils literal notranslate"><span class="pre">positions</span></code> (Star positions)
- <code class="docutils literal notranslate"><span class="pre">C_poly</span></code>  Tensor or None, optional</p>
<blockquote>
<div><p>The Zernike coefficient matrix used in generating simulations of the PSF model. This
matrix defines the Zernike polynomials up to a given order used to simulate the PSF
field. It may be present in some datasets or only required for some classes.
If not present or required, the model will proceed without it.</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary containing the RMSE, relative RMSE, and their
corresponding standard deviation values.</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rmse</span></code><span class="classifier">float</span></dt><dd><p>Root Mean Square Error (RMSE).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">rel_rmse</span></code><span class="classifier">float</span></dt><dd><p>Relative RMSE.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">std_rmse</span></code><span class="classifier">float</span></dt><dd><p>Standard deviation of RMSE.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">std_rel_rmse</span></code><span class="classifier">float</span></dt><dd><p>Standard deviation of relative RMSE.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_shape">
<span class="sig-name descname"><span class="pre">evaluate_metrics_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">simPSF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/wf_psf/metrics/metrics_interface.html#MetricsParamsHandler.evaluate_metrics_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.metrics.metrics_interface.MetricsParamsHandler.evaluate_metrics_shape" title="Link to this definition"></a></dt>
<dd><p>Evaluate PSF Shape Metrics.</p>
<p>Computes shape-related metrics for the PSF model, including RMSE,
relative RMSE, and their standard deviations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psf_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – Instance of the PSF model selected for evaluation.</p></li>
<li><p><strong>simPSF</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – Instance of the PSFSimulator.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – A DataConfigHandler object containing training and test datasets.</p></li>
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – <p>Dictionary containing dataset details, including:
- <code class="docutils literal notranslate"><span class="pre">SEDs</span></code> (Spectral Energy Distributions)
- <code class="docutils literal notranslate"><span class="pre">positions</span></code> (Star positions)
- <code class="docutils literal notranslate"><span class="pre">C_poly</span></code> (Tensor or None, optional)</p>
<blockquote>
<div><p>The Zernike coefficient matrix used in generating simulations of the PSF model. This
matrix defines the Zernike polynomials up to a given order used to simulate the PSF
field. It may be present in some datasets or only required for some classes.
If not present or required, the model will proceed without it.</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>shape_results</strong> – Dictionary containing RMSE, Relative RMSE values, and
corresponding Standard Deviation values for PSF Shape metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.metrics.metrics_interface.evaluate_model">
<span class="sig-prename descclassname"><span class="pre">wf_psf.metrics.metrics_interface.</span></span><span class="sig-name descname"><span class="pre">evaluate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trained_model_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/wf_psf/metrics/metrics_interface.html#evaluate_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.metrics.metrics_interface.evaluate_model" title="Link to this definition"></a></dt>
<dd><p>Evaluate the trained model on both training and test datasets by computing various metrics.</p>
<p>The metrics to evaluate are determined by the configuration in <cite>metrics_params</cite> and <cite>metric_evaluation_flags</cite>.
Metrics are computed for both the training and test datasets, and results are stored in a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics_params</strong> (<em>Recursive Namespace object</em>) – Recursive Namespace object containing metrics input parameters</p></li>
<li><p><strong>trained_model_params</strong> (<em>Recursive Namespace object</em>) – Recursive Namespace object containing trained model input parameters</p></li>
<li><p><strong>data</strong> (<em>DataHandler object</em>) – DataHandler object containing training and test data</p></li>
<li><p><strong>psf_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a>) – PSF model object</p></li>
<li><p><strong>weights_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Directory location of model weights</p></li>
<li><p><strong>metrics_output</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Directory location of metrics output</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="wf_psf.metrics.metrics.html" class="btn btn-neutral float-left" title="wf_psf.metrics.metrics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="wf_psf.plotting.html" class="btn btn-neutral float-right" title="wf_psf.plotting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023–2026, CosmoStat.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XXXXXXXXXX', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>