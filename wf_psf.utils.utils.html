<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wf_psf.utils.utils module &mdash; wf-psf 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/twemoji.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=af2ce170"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js"></script>
        <script src="_static/twemoji.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="wf_psf.info module" href="wf_psf.info.html" />
    <link rel="prev" title="wf_psf.utils.read_config module" href="wf_psf.utils.read_config.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #ffb400" >

          
          
          <a href="index.html" class="icon icon-home">
            wf-psf
              <img src="_static/cosmostat_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About WaveDiff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installing WaveDiff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Running WaveDiff</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic_execution.html">Basic Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="wf_psf.html">wf_psf package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="wf_psf.data.html">wf_psf.data package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.metrics.html">wf_psf.metrics package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.plotting.html">wf_psf.plotting package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.psf_models.html">wf_psf.psf_models package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.sims.html">wf_psf.sims package</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.training.html">wf_psf.training package</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="wf_psf.utils.html">wf_psf.utils package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="wf_psf.utils.configs_handler.html">wf_psf.utils.configs_handler module</a></li>
<li class="toctree-l3"><a class="reference internal" href="wf_psf.utils.graph_utils.html">wf_psf.utils.graph_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="wf_psf.utils.io.html">wf_psf.utils.io module</a></li>
<li class="toctree-l3"><a class="reference internal" href="wf_psf.utils.read_config.html">wf_psf.utils.read_config module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">wf_psf.utils.utils module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.info.html">wf_psf.info module</a></li>
<li class="toctree-l2"><a class="reference internal" href="wf_psf.run.html">wf_psf.run module</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="z_ref.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #ffb400" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">wf-psf</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="wf_psf.html">wf_psf package</a></li>
          <li class="breadcrumb-item"><a href="wf_psf.utils.html">wf_psf.utils package</a></li>
      <li class="breadcrumb-item active">wf_psf.utils.utils module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/wf_psf.utils.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-wf_psf.utils.utils">
<span id="wf-psf-utils-utils-module"></span><h1>wf_psf.utils.utils module<a class="headerlink" href="#module-wf_psf.utils.utils" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="wf_psf.utils.utils.IndependentZernikeInterpolation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">IndependentZernikeInterpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tf_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tf_zks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#IndependentZernikeInterpolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.IndependentZernikeInterpolation" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolate each Zernike polynomial independently</p>
<p>The interpolation is done independently for each Zernike polynomial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tf_pos</strong> (<em>Tensor</em><em> (</em><em>n_sources</em><em>, </em><em>2</em><em>)</em>) – Positions</p></li>
<li><p><strong>tf_zks</strong> (<em>Tensor</em><em> (</em><em>n_sources</em><em>, </em><em>n_zernikes</em><em>)</em>) – Zernike coefficients for each position</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Order of the RBF interpolation.
Default is 2, corresponds to thin plate interp (r^2*log(r))</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#wf_psf.utils.utils.IndependentZernikeInterpolation.interp_one_zk" title="wf_psf.utils.utils.IndependentZernikeInterpolation.interp_one_zk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp_one_zk</span></code></a>(zk_prior)</p></td>
<td><p>Interpolate each Zerkine polynomial independently</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#wf_psf.utils.utils.IndependentZernikeInterpolation.interpolate_zks" title="wf_psf.utils.utils.IndependentZernikeInterpolation.interpolate_zks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interpolate_zks</span></code></a>(target_pos)</p></td>
<td><p>Vectorize to interpolate to each Zernike!</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.utils.utils.IndependentZernikeInterpolation.interp_one_zk">
<span class="sig-name descname"><span class="pre">interp_one_zk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zk_prior</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#IndependentZernikeInterpolation.interp_one_zk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.IndependentZernikeInterpolation.interp_one_zk" title="Link to this definition"></a></dt>
<dd><p>Interpolate each Zerkine polynomial independently</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.utils.utils.IndependentZernikeInterpolation.interpolate_zks">
<span class="sig-name descname"><span class="pre">interpolate_zks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#IndependentZernikeInterpolation.interpolate_zks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.IndependentZernikeInterpolation.interpolate_zks" title="Link to this definition"></a></dt>
<dd><p>Vectorize to interpolate to each Zernike!</p>
<p>Each zernike is computed indepently from the others.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wf_psf.utils.utils.NoiseEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">NoiseEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_rad</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#NoiseEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.NoiseEstimator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Noise estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Image size</p></li>
<li><p><strong>win_rad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – window radius in pixels</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#wf_psf.utils.utils.NoiseEstimator.estimate_noise" title="wf_psf.utils.utils.NoiseEstimator.estimate_noise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_noise</span></code></a>(image)</p></td>
<td><p>Estimate the noise level of the image.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#wf_psf.utils.utils.NoiseEstimator.sigma_mad" title="wf_psf.utils.utils.NoiseEstimator.sigma_mad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma_mad</span></code></a>(x)</p></td>
<td><p>Compute an estimation of the standard deviation of a Gaussian distribution using the robust MAD (Median Absolute Deviation) estimator.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.utils.utils.NoiseEstimator.estimate_noise">
<span class="sig-name descname"><span class="pre">estimate_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#NoiseEstimator.estimate_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.NoiseEstimator.estimate_noise" title="Link to this definition"></a></dt>
<dd><p>Estimate the noise level of the image.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.utils.utils.NoiseEstimator.sigma_mad">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sigma_mad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#NoiseEstimator.sigma_mad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.NoiseEstimator.sigma_mad" title="Link to this definition"></a></dt>
<dd><p>Compute an estimation of the standard deviation
of a Gaussian distribution using the robust
MAD (Median Absolute Deviation) estimator.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.PI_zernikes">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">PI_zernikes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tf_z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tf_z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#PI_zernikes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.PI_zernikes" title="Link to this definition"></a></dt>
<dd><p>Compute internal product between zernikes and OPDs</p>
<p>Defined such that Zernikes are orthonormal to each other</p>
<p>First one should compute: norm_factor =  PI_zernikes(tf_zernike,tf_zernike)
for futur calls: PI_zernikes(OPD,tf_zernike_k, norm_factor)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wf_psf.utils.utils.ZernikeInterpolation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">ZernikeInterpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tf_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tf_zks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#ZernikeInterpolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.ZernikeInterpolation" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolate zernikes</p>
<p>This class helps to interpolate zernikes using only the closest K elements
in a given dataset using a RBF interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tf_pos</strong> (<em>Tensor</em><em> (</em><em>n_sources</em><em>, </em><em>2</em><em>)</em>) – Positions</p></li>
<li><p><strong>tf_zks</strong> (<em>Tensor</em><em> (</em><em>n_sources</em><em>, </em><em>n_zernikes</em><em>)</em>) – Zernike coefficients for each position</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of elements to use for the interpolation.
Default is 50</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Order of the RBF interpolation.
Default is 2, corresponds to thin plate interp (r^2*log(r))</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#wf_psf.utils.utils.ZernikeInterpolation.interpolate_zk" title="wf_psf.utils.utils.ZernikeInterpolation.interpolate_zk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interpolate_zk</span></code></a>(single_pos)</p></td>
<td><p>Interpolate a single position</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#wf_psf.utils.utils.ZernikeInterpolation.interpolate_zks" title="wf_psf.utils.utils.ZernikeInterpolation.interpolate_zks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interpolate_zks</span></code></a>(interp_positions)</p></td>
<td><p>Vectorize to interpolate to each position</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.utils.utils.ZernikeInterpolation.interpolate_zk">
<span class="sig-name descname"><span class="pre">interpolate_zk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">single_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#ZernikeInterpolation.interpolate_zk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.ZernikeInterpolation.interpolate_zk" title="Link to this definition"></a></dt>
<dd><p>Interpolate a single position</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wf_psf.utils.utils.ZernikeInterpolation.interpolate_zks">
<span class="sig-name descname"><span class="pre">interpolate_zks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interp_positions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#ZernikeInterpolation.interpolate_zks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.ZernikeInterpolation.interpolate_zks" title="Link to this definition"></a></dt>
<dd><p>Vectorize to interpolate to each position</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.add_noise">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_SNR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#add_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.add_noise" title="Link to this definition"></a></dt>
<dd><p>Add noise to an image to obtain a desired SNR.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.calc_poly_position_mat">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">calc_poly_position_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_lims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_lims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#calc_poly_position_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.calc_poly_position_mat" title="Link to this definition"></a></dt>
<dd><p>Calculate a matrix with position polynomials.</p>
<p>Scale positions to the square:
[self.x_lims[0], self.x_lims[1]] x [self.y_lims[0], self.y_lims[1]]
to the square [-1,1] x [-1,1]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.calc_wfe">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">calc_wfe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zernike_basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#calc_wfe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.calc_wfe" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.calc_wfe_rms">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">calc_wfe_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zernike_basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pupil_mask</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#calc_wfe_rms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.calc_wfe_rms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.convert_to_tf">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">convert_to_tf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tf_dtype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#convert_to_tf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.convert_to_tf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.decimate_im">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">decimate_im</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decim_f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#decimate_im"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.decimate_im" title="Link to this definition"></a></dt>
<dd><p>Decimate image.</p>
<p>Decimated by a factor of decim_f.
Based on the PIL library using the default interpolator.
Default: PIL.Image.BICUBIC.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.downsample_im">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">downsample_im</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#downsample_im"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.downsample_im" title="Link to this definition"></a></dt>
<dd><p>Downsample image.</p>
<p>Based on opencv function resize.
[doc](<a class="reference external" href="https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#void%20resize(InputArray%20src,%20OutputArray%20dst,%20Size%20dsize,%20double%20fx,%20double%20fy,%20int%20interpolation">https://docs.opencv.org/2.4/modules/imgproc/doc/geometric_transformations.html#void%20resize(InputArray%20src,%20OutputArray%20dst,%20Size%20dsize,%20double%20fx,%20double%20fy,%20int%20interpolation</a>))
The input image is downsampled to the dimensions specified in <cite>output_dim</cite>.
The downsampling method is based on the <cite>INTER_AREA</cite> method.
See [tensorflow_doc](<a class="reference external" href="https://www.tensorflow.org/api_docs/cc/class/tensorflow/ops/resize-area">https://www.tensorflow.org/api_docs/cc/class/tensorflow/ops/resize-area</a>)
Each output pixel is computed by first transforming the pixel’s footprint
into the input tensor and then averaging the pixels that intersect the
footprint. An input pixel’s contribution to the average is weighted by the
fraction of its area that intersects the footprint.
This is the same as OpenCV’s INTER_AREA.
An explanation of the INTER_AREA method can be found in the next
[link](<a class="reference external" href="https://medium.com/&#64;wenrudong/what-is-opencvs-inter-area-actually-doing-282a626a09b3">https://medium.com/&#64;wenrudong/what-is-opencvs-inter-area-actually-doing-282a626a09b3</a>).</p>
<p>This version should be consistent with the tensorflow one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_im</strong> (<em>np.ndarray</em><em> (</em><em>dim_x</em><em>, </em><em>dim_y</em><em>)</em>) – input image</p></li>
<li><p><strong>output_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Contains the dimension of the square output image.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.generate_SED_elems">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">generate_SED_elems</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SED</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_psf_toolkit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#generate_SED_elems"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.generate_SED_elems" title="Link to this definition"></a></dt>
<dd><p>Generate SED Elements.</p>
<p>A function to generate the SED elements needed for using the
Tensor Flow class: TF_poly_PSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SED</strong> – </p></li>
<li><p><strong>sim_psf_toolkit</strong> – An instance of the SimPSFToolkit class with the correct</p></li>
<li><p><strong>values.</strong> (<em>initialization</em>) – </p></li>
<li><p><strong>n_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of wavelength bins</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.generate_SED_elems_in_tensorflow">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">generate_SED_elems_in_tensorflow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SED</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_psf_toolkit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tf_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.float64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#generate_SED_elems_in_tensorflow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.generate_SED_elems_in_tensorflow" title="Link to this definition"></a></dt>
<dd><p>Generate SED Elements in Tensor Flow Units.</p>
<p>A function to generate the SED elements needed for using the
Tensor Flow class: TF_poly_PSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SED</strong> – </p></li>
<li><p><strong>sim_psf_toolkit</strong> – An instance of the SimPSFToolkit class with the correct</p></li>
<li><p><strong>values.</strong> (<em>initialization</em>) – </p></li>
<li><p><strong>n_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of wavelength bins</p></li>
<li><p><strong>tf_dtype</strong> (<em>tf.</em>) – Tensor Flow data type</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.generate_packed_elems">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">generate_packed_elems</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SED</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_psf_toolkit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#generate_packed_elems"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.generate_packed_elems" title="Link to this definition"></a></dt>
<dd><p>Generate Packed Elements.
This name is too generic. may make obsolete</p>
<p>A function to store the packed values for using the TF_poly_PSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SED</strong> – </p></li>
<li><p><strong>sim_psf_toolkit</strong> – </p></li>
<li><p><strong>n_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of wavelength bins</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tensors</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.load_multi_cycle_params_click">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">load_multi_cycle_params_click</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#load_multi_cycle_params_click"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.load_multi_cycle_params_click" title="Link to this definition"></a></dt>
<dd><p>Load multiple cycle training parameters.</p>
<p>For backwards compatibility, the training parameters are received as a string,
separated and stored in the args dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>dictionary</em>) – Comand line arguments dictionary loaded with the click package.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>args</strong> – The input dictionary with all multi-cycle training parameters correctly loaded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.resize">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsize</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">dst</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">fx</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dst</span></span></span><a class="headerlink" href="#wf_psf.utils.utils.resize" title="Link to this definition"></a></dt>
<dd><p>.   &#64;brief Resizes an image.
.
.   The function resize resizes the image src down to or up to the specified size. Note that the
.   initial dst type or size are not taken into account. Instead, the size and type are derived from
.   the <cite>src</cite>,`dsize`,`fx`, and <cite>fy</cite>. If you want to resize src so that it fits the pre-created dst,
.   you may call the function as follows:
.   &#64;code
.       // explicitly specify dsize=dst.size(); fx and fy will be computed from that.
.       resize(src, dst, dst.size(), 0, 0, interpolation);
.   &#64;endcode
.   If you want to decimate the image by factor of 2 in each direction, you can call the function this
.   way:
.   &#64;code
.       // specify fx and fy and let the function compute the destination image size.
.       resize(src, dst, Size(), 0.5, 0.5, interpolation);
.   &#64;endcode
.   To shrink an image, it will generally look best with #INTER_AREA interpolation, whereas to
.   enlarge an image, it will generally look best with #INTER_CUBIC (slow) or #INTER_LINEAR
.   (faster but still looks OK).
.
.   &#64;param src input image.
.   &#64;param dst output image; it has the size dsize (when it is non-zero) or the size computed from
.   src.size(), fx, and fy; the type of dst is the same as of src.
.   &#64;param dsize output image size; if it equals zero (<cite>None</cite> in Python), it is computed as:
.    f[texttt{dsize = Size(round(fx*src.cols), round(fy*src.rows))}f]
.    Either dsize or both fx and fy must be non-zero.
.   &#64;param fx scale factor along the horizontal axis; when it equals 0, it is computed as
.   f[texttt{(double)dsize.width/src.cols}f]
.   &#64;param fy scale factor along the vertical axis; when it equals 0, it is computed as
.   f[texttt{(double)dsize.height/src.rows}f]
.   &#64;param interpolation interpolation method, see #InterpolationFlags
.
.   &#64;sa  warpAffine, warpPerspective, remap</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.scale_to_range">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">scale_to_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_range</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#scale_to_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.scale_to_range" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wf_psf.utils.utils.zernike_generator">
<span class="sig-prename descclassname"><span class="pre">wf_psf.utils.utils.</span></span><span class="sig-name descname"><span class="pre">zernike_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_zernikes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wfe_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wf_psf/utils/utils.html#zernike_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wf_psf.utils.utils.zernike_generator" title="Link to this definition"></a></dt>
<dd><p>Generate Zernike maps.</p>
<p>Based on the zernike github repository.
<a class="reference external" href="https://github.com/jacopoantonello/zernike">https://github.com/jacopoantonello/zernike</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_zernikes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of Zernike modes desired.</p></li>
<li><p><strong>wfe_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Dimension of the Zernike map [wfe_dim x wfe_dim].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>zernikes</strong> – List containing the Zernike modes.
The values outside the unit circle are filled with NaNs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a> of np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="wf_psf.utils.read_config.html" class="btn btn-neutral float-left" title="wf_psf.utils.read_config module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="wf_psf.info.html" class="btn btn-neutral float-right" title="wf_psf.info module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, CosmoStat.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XXXXXXXXXX', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>